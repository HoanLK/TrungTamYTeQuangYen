function TransMenu(n,t,i,r,u,f){function nt(n,i,r,u){var f=new TransMenuItem(n,i,this,r,u,p+"-"+this.items.length,t);f._index=this.items.length;this.items[f._index]=f}function tt(n,i,r){var f,e,u;if(!n.parentMenu==this)throw new Error("Cannot add a menu here");return f=TransMenu.direction.right,e=TransMenu.reference.topRight,(t==TransMenu.direction.left||t==TransMenu.direction.dleft)&&(f=TransMenu.direction.left,e=TransMenu.reference.topLeft),c==null&&(c=new TransMenuSet(f,i,r,e)),u=c.addMenu(n),s[n._index]=u,u.onmouseover=dt,u.ondeactivate=gt,u.onqueue=ni,u.ondequeue=ti,u}function it(){ht();ct();st();w=!0}function rt(){w&&(o.isOpen=!0,h=!0,ft(),e.clip.style.visibility="visible",e.clip.style.zIndex=TransMenu._maxZ++,d(),TransMenu.selecthack,o.onactivate())}function ut(){if(w){o.isOpen=!1;h=!0;for(var t=0,i=null;i=e.item[t];t++)k(i);c&&c.hide();d();TransMenu.selecthack;n.parentMenu==null&&TransMenu.fontFace!="none"&&TransMenu.fontFace&&TransMenu.activeId!=n.id&&Cufon.replace("#"+n.id,{color:TransMenu.fontColor,fontFamily:TransMenu.fontFace});o.ondeactivate()}}function ft(){var l=n.constructor==TransMenuItem,f=l?n.parentMenu.elmCache.item[n._index]:n,o=f,h=0,s=0,c=navigator.userAgent.toLowerCase(),a=-1,p,w,b;if(navigator.appName=="Microsoft Internet Explorer"&&(c=navigator.userAgent,p=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),p.exec(c)!=null&&(a=parseFloat(RegExp.$1))),c.indexOf("opera")>=0)var k=0,d=(window.innerWidth?window.innerWidth+document.body.scrollLeft:document.body.clientWidth+document.body.scrollLeft)-parseInt(e.clip.style.width),g=0,nt=(window.innerHeight?window.innerHeight+document.body.scrollTop:document.body.clientHeight+document.body.scrollTop)-parseInt(e.clip.style.height);else if(a>=9)var k=0,d=document.documentElement.clientWidth+document.documentElement.scrollLeft-parseInt(e.clip.style.width),g=0,nt=document.documentElement.clientHeight+document.documentElement.scrollTop-parseInt(e.clip.style.height);else var k=0,d=(window.innerWidth?window.innerWidth+window.scrollX:document.documentElement.clientWidth+document.documentElement.scrollLeft)-parseInt(e.clip.style.width),g=0,nt=(window.innerHeight?window.innerHeight+window.scrollY:document.documentElement.clientHeight+document.documentElement.scrollTop)-parseInt(e.clip.style.height);for(count=0;l?o.parentNode.className.indexOf("transMenu")==-1:o.offsetParent;)(o.id.indexOf("menu")>-1||l)&&(h+=o.offsetLeft,s+=o.offsetTop),count++,o.scrollLeft&&(h-=o.scrollLeft),o.scrollTop&&(s-=o.scrollTop),o=o.offsetParent;f.childNodes[0];f.childNodes[0];n.constructor==TransMenuItem&&(h+=parseInt(o.parentNode.style.left),s+=parseInt(o.parentNode.style.top));switch(u){case TransMenu.reference.topRight:h+=f.offsetWidth;break;case TransMenu.reference.bottomLeft:s+=f.offsetHeight;break;case TransMenu.reference.bottomRight:h+=f.offsetWidth;s+=f.offsetHeight}h+=o.offsetLeft;s+=o.offsetTop;f.tagName=="TR"&&f.childNodes[0]&&c.indexOf("safari")>=0&&(start=c.indexOf("safari"),ver=parseInt(c.substring(start+7,start+10)),t==4?ver<500&&(s+=f.childNodes[0].offsetTop):(xx_offset=0,TransMenu.sub_indicator&&(xx_offset=f.childNodes[1].offsetWidth),ver<500&&(h+=f.childNodes[0].offsetLeft+f.childNodes[0].offsetWidth+xx_offset,s+=f.childNodes[0].offsetTop)));f.tagName=="TR"&&c.indexOf("opera")>=0;h+=i;s+=r;TransMenu.autoposition&&c.indexOf("opera")==-1&&(h=Math.max(Math.min(h,d),k),s=Math.max(Math.min(s,nt),g));w=e.items.offsetWidth;b=e.items.offsetHeight;v=b+TransMenu.shadowSize;y=w+TransMenu.shadowSize;t==TransMenu.direction.up&&(s-=v);(t==TransMenu.direction.left||t==TransMenu.direction.dleft)&&(h-=y);e.clip.style.left=h+"px";e.clip.style.top=s+"px"}function d(){var n=parseInt(e.content.style[b]),t=o.isOpen?0:-a;l!=null&&l.stop();l=new Accelimation(n,t,TransMenu.slideTime,g);l.onframe=et;l.onend=ot;l.start()}function et(n){e.content.style[b]=n+"px"}function ot(){o.isOpen||(e.clip.style.visibility="hidden");h=!1}function st(){var n=e.items.offsetWidth,i=e.items.offsetHeight,r=navigator.userAgent.toLowerCase();e.clip.style.width=n+TransMenu.shadowSize+2+"px";e.clip.style.height=i+TransMenu.shadowSize+2+"px";e.content.style.width=n+TransMenu.shadowSize+"px";e.content.style.height=i+TransMenu.shadowSize+"px";v=i+TransMenu.shadowSize;y=n+TransMenu.shadowSize;a=t==TransMenu.direction.down||t==TransMenu.direction.up?v:y;(t==TransMenu.direction.left||t==TransMenu.direction.up)&&(a=-a);e.content.style[b]=-a-TransMenu.shadowSize+"px";e.clip.style.visibility="hidden";r.indexOf("mac")==-1||r.indexOf("gecko")>-1?(e.background.style.width=n+"px",e.background.style.height=i+"px",e.shadowRight.style.left=n+"px",e.shadowRight.style.height=i-(TransMenu.shadowOffset-TransMenu.shadowSize)+"px",e.shadowRight.style.backgroundColor=TransMenu.shadowColor,e.shadowBottom.style.top=i+"px",e.shadowBottom.style.width=n-TransMenu.shadowOffset+"px",e.shadowBottom.style.backgroundColor=TransMenu.shadowColor):(e.background.firstChild.src=TransMenu.backgroundPng,e.background.firstChild.width=n,e.background.firstChild.height=i,e.shadowRight.firstChild.src=TransMenu.shadowPng,e.shadowRight.style.left=n+"px",e.shadowRight.firstChild.width=TransMenu.shadowSize,e.shadowRight.firstChild.height=i-(TransMenu.shadowOffset-TransMenu.shadowSize),e.shadowBottom.firstChild.src=TransMenu.shadowPng,e.shadowBottom.style.top=i+"px",e.shadowBottom.firstChild.height=TransMenu.shadowSize,e.shadowBottom.firstChild.width=n-TransMenu.shadowOffset)}function ht(){var t=document.getElementById(p),r=t.all?t.all:t.getElementsByTagName("*"),i,n;for(e={},e.clip=t,e.item=[],i=0,n=null;n=r[i];i++)switch(n.className){case"items":case"content":case"background":case"shadowRight":case"shadowBottom":e[n.className]=n;break;case"item":n._index=e.item.length;e.item[n._index]=n}o.elmCache=e}function ct(){for(var i=0,t=null;t=e.item[i];i++)t.onmouseover=at,t.onmouseout=vt,t.onclick=yt;typeof n.tagName!="undefined"&&(n.onmouseover=pt,n.onmouseout=wt);e.content.onmouseover=bt;e.content.onmouseout=kt}function lt(n){n.className="item hover";s[n._index]&&TransMenu.sub_indicator&&n.lastChild.firstChild.src&&(n.lastChild.firstChild.src=TransMenu.dingbatOn)}function k(n){n.className="item";s[n._index];s[n._index]&&TransMenu.sub_indicator&&n.lastChild.firstChild.src&&(n.lastChild.firstChild.src=TransMenu.dingbatOff)}function at(){h||(lt(this),s[this._index]?c.showMenu(s[this._index]):c&&c.hide())}function vt(){h||s[this._index]||k(this)}function yt(){h||o.items[this._index].url&&(o.items[this._index].target=="1"?window.open(o.items[this._index].url,"_blank"):o.items[this._index].target=="2"?window.open(o.items[this._index].url,"","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=780,height=550"):location.href=o.items[this._index].target=="3"?void 0:o.items[this._index].url)}function pt(){f.showMenu(o)}function wt(){f.hideMenu(o)}function bt(){h||(f.showMenu(o),o.onmouseover())}function kt(){h||f.hideMenu(o)}function dt(){h||f.showMenu(o)}function gt(){for(var n=0;n<s.length;n++)if(s[n]==this){k(e.item[n]);break}}function ni(){f.hideMenu(o)}function ti(){f.showMenu(o)}function ii(){for(var i=[],u="transMenu"+(n.constructor!=TransMenuItem?" top":""),t=0,r=null;r=this.items[t];t++)i[t]=r.toString(s[t]);return'<div id="'+p+'" class="'+u+'" style=""><div class="content"><table class="items" cellpadding="0" cellspacing="0" border="0">'+i.join("")+'<\/table><div class="shadowBottom"><\/div><div class="shadowRight"><\/div><div class="background"><\/div><\/div><\/div>'}this.addItem=nt;this.addMenu=tt;this.toString=ii;this.initialize=it;this.isOpen=!1;this.show=rt;this.hide=ut;this.items=[];this.onactivate=new Function;this.ondeactivate=new Function;this.onmouseover=new Function;this.onqueue=new Function;this.ondequeue=new Function;this.index=TransMenu.registry.length;TransMenu.registry[this.index]=this;var p="TransMenu"+this.index,v=null,y=null,c=null,h=!1,s=[],g=-1,e=null,w=!1,o=this,l=null,b=t==TransMenu.direction.down||t==TransMenu.direction.up||t==TransMenu.direction.dleft?"top":"left",a=null}function TransMenuSet(n,t,i,r){function c(u){var e=new TransMenu(u,n,t,i,r,this);return f[f.length]=e,e}function l(n){n!=u?(u!=null&&o(u),u=n,n.show()):e(n)}function a(n){u==n&&n.isOpen&&(n.hideTimer||v(n))}function v(n){n.onqueue();n.hideTimer=window.setTimeout("TransMenuSet.registry["+h.index+"].hide(TransMenu.registry["+n.index+"])",TransMenu.hideDelay)}function e(n){n.hideTimer&&(n.ondequeue(),window.clearTimeout(n.hideTimer),n.hideTimer=null)}function o(n){!n&&u&&(n=u);n&&u==n&&n.isOpen&&s()}function s(){null!=u&&(e(u),u.hideTimer=null,u.hide(),u=null)}this.addMenu=c;this.showMenu=l;this.hideMenu=a;this.hide=o;this.hideCurrent=s;var f=[],h=this,u=null;this.index=TransMenuSet.registry.length;TransMenuSet.registry[this.index]=this}function TransMenuItem(n,t,i,r,u,f,e){function h(t){var r=t?TransMenu.dingbatOff:TransMenu.spacerGif,u=TransMenu.itemPadding+TransMenu.menuPadding,s="padding:"+TransMenu.itemPadding+"px; padding-left:"+u+"px;",h="padding:"+TransMenu.itemPadding+"px; padding-right:"+u+"px;",i='<tr class="item">';return TransMenu.sub_indicator&&(e==TransMenu.direction.left||e==TransMenu.direction.dleft)?(i+='<td align="left" style="'+h+'border-right:0;" class="'+o+' transImage"><img src="'+r+'" align="left"><\/td>',i+='<td style="'+s+'border-left:0;" id="'+f+'" class="'+o+'">'+n+"<\/td>"):TransMenu.sub_indicator&&(e==TransMenu.direction.down||e==TransMenu.direction.right||e==TransMenu.direction.up)?(i+='<td style="'+s+'border-right:0;" id="'+f+'" class="'+o+'" >'+n+"<\/td>",i+='<td  align="right" width="10" style="'+h+'border-left:0;" class="'+o+' transImage" ><img src="'+r+'" align="right"><\/td>'):i+='<td id="'+f+'" class="'+o+'" >'+n+"<\/td>",i+"<\/tr>"}this.toString=h;this.text=n;this.url=t;this.target=r;this.parentMenu=i;var o="",s=f.substring(f.length-2,f.length);s=="-0"&&(o="top_item")}function Accelimation(n,t,i,r){typeof r=="undefined"&&(r=0);typeof unit=="undefined"&&(unit="px");this.x0=n;this.x1=t;this.dt=i;this.zip=-r;this.unit=unit;this.timer=null;this.onend=new Function;this.onframe=new Function}var cearElementProps,WCH_Constructor,WCH;TransMenu.spacerGif="img/x.gif";TransMenu.dingbatOn="img/submenu-on.gif";TransMenu.dingbatOff="img/submenu-off.gif";TransMenu.dingbatSize=14;TransMenu.menuPadding=5;TransMenu.itemPadding=3;TransMenu.shadowSize=2;TransMenu.shadowOffset=3;TransMenu.shadowColor="#888";TransMenu.shadowPng="img/grey-40.png";TransMenu.backgroundColor="white";TransMenu.backgroundPng="img/white-90.png";TransMenu.hideDelay=1e3;TransMenu.slideTime=400;TransMenu.fontFace="none";TransMenu.activeId="none";TransMenu.fontColor="#000";TransMenu.preview=0;TransMenu.autoposition=1;TransMenu.reference={topLeft:1,topRight:2,bottomLeft:3,bottomRight:4};TransMenu.direction={down:1,right:2,up:3,left:4,dleft:5};TransMenu.registry=[];TransMenu._maxZ=100;TransMenu.isSupported=function(){var t=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),r=navigator.appName,n=!0;return t.indexOf("gecko")>-1&&navigator.productSub>=20020605?n=!0:r=="Microsoft Internet Explorer"&&document.getElementById&&(n=i.indexOf("mac")==0?/msie (\d(.\d*)?)/.test(t)&&Number(RegExp.$1)>=5.1:!0),n};TransMenu.initialize=function(){for(var n=0,t=null;t=this.registry[n];n++)t.initialize()};TransMenu.renderAll=function(){for(var n=[],t=0,i=null;i=this.registry[t];t++)n[t]=i.toString();TransMenu.preview==1?$("#subwrap").append(n.join("")):document.write(n.join(""))};TransMenuSet.registry=[];Accelimation.prototype.start=function(){this.t0=(new Date).getTime();this.t1=this.t0+this.dt;var n=this.x1-this.x0;this.c1=this.x0+(1+this.zip)*n/3;this.c2=this.x0+(2+this.zip)*n/3;Accelimation._add(this)};Accelimation.prototype.stop=function(){Accelimation._remove(this)};Accelimation.prototype._paint=function(n){if(n<this.t1){var t=n-this.t0;this.onframe(Accelimation._getBezier(t/this.dt,this.x0,this.x1,this.c1,this.c2))}else this._end()};Accelimation.prototype._end=function(){Accelimation._remove(this);this.onframe(this.x1);this.onend()};Accelimation._add=function(n){var t=this.instances.length;this.instances[t]=n;this.instances.length==1&&(this.timerID=window.setInterval("Accelimation._paintAll()",this.targetRes))};Accelimation._remove=function(n){for(var t=0;t<this.instances.length;t++)if(n==this.instances[t]){this.instances=this.instances.slice(0,t).concat(this.instances.slice(t+1));break}this.instances.length==0&&(window.clearInterval(this.timerID),this.timerID=null)};Accelimation._paintAll=function(){for(var t=(new Date).getTime(),n=0;n<this.instances.length;n++)this.instances[n]._paint(t)};Accelimation._B1=function(n){return n*n*n};Accelimation._B2=function(n){return 3*n*n*(1-n)};Accelimation._B3=function(n){return 3*n*(1-n)*(1-n)};Accelimation._B4=function(n){return(1-n)*(1-n)*(1-n)};Accelimation._getBezier=function(n,t,i,r,u){return i*this._B1(n)+u*this._B2(n)+r*this._B3(n)+t*this._B4(n)};Accelimation.instances=[];Accelimation.targetRes=10;Accelimation.timerID=null;window.attachEvent&&(cearElementProps=["data","onmouseover","onmouseout","onmousedown","onmouseup","ondblclick","onclick","onselectstart","oncontextmenu"],window.attachEvent("onunload",function(){for(var n,t,i=document.all.length;i--;)for(t=document.all[i],n=cearElementProps.length;n--;)t[cearElementProps[n]]=null}));WCH_Constructor=function(){function u(n,t,r){var o=e(n),c=(oTmp=e(t))?oTmp:document.getElementsByTagName("body")[0],s,l,u,h;if(o&&c){if(s=document.getElementById("WCHhider"+o.id),s)r&&f(s,o);else{if((l=i?"filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);":"",u=o.style.zIndex,u==""&&(u=o.currentStyle.zIndex),u=parseInt(u),isNaN(u))||u<2)return null;u--;h="WCHhider"+o.id;c.insertAdjacentHTML("afterBegin",'<iframe class="WCHiframe" src="javascript:false;" id="'+h+'" scroll="no" frameborder="0" style="position:absolute;visibility:hidden;'+l+"border:0;top:0;left;0;width:0;height:0;background-color:#ccc;z-index:"+u+';"><\/iframe>');s=document.getElementById(h);f(s,o)}return s}}function f(n,t){n.style.width=t.offsetWidth+"px";n.style.height=t.offsetHeight+"px";n.style.left=t.offsetLeft+"px";n.style.top=t.offsetTop+"px"}function e(n){var t=null;switch(typeof n){case"object":t=n;break;case"string":t=document.getElementById(n)}return t}function o(){if(t=typeof document.body.contentEditable!="undefined",i=typeof document.compatMode!="undefined",!t){document.styleSheets.length==0&&document.createStyleSheet();var u=document.styleSheets[0];u.addRule(".WCHhider","visibility:visible");n=u.rules(u.rules.length-1)}r=!1}if(!(document.all&&document.getElementById&&!window.opera&&navigator.userAgent.toLowerCase().indexOf("mac")==-1)){this.Apply=function(){};this.Discard=function(){};return}var t=!1,i=!1,n=null,r=!0,s=this;this.Apply=function(i,f,e){r&&o();t&&(oIframe=u(i,f,e))?oIframe.style.visibility="visible":n!=null&&(n.style.visibility="hidden")};this.Discard=function(i,r){t&&(oIframe=u(i,r,!1))?oIframe.style.visibility="hidden":n!=null&&(n.style.visibility="visible")}};WCH=new WCH_Constructor;